# ç¬¬ 6 è¯¾ï¼šç»“æ„ä½“ ğŸ—ï¸

ç»“æ„ä½“å…è®¸ä½ å°†ä¸åŒç±»å‹çš„æ•°æ®ç»„åˆåœ¨ä¸€èµ·ã€‚è¿™æ˜¯åˆ›å»ºå¤æ‚æ•°æ®ç»“æ„çš„åŸºç¡€ã€‚

---

## 6.1 ä¸ºä»€ä¹ˆéœ€è¦ç»“æ„ä½“ï¼Ÿ

é—®é¢˜ï¼šå¦‚ä½•è¡¨ç¤ºä¸€æ¡è›‡ï¼Ÿ

```c
// âŒ ä½¿ç”¨å¤šä¸ªç‹¬ç«‹å˜é‡
int snake_x1 = 10, snake_y1 = 10;
int snake_x2 = 9,  snake_y2 = 10;
int snake_x3 = 8,  snake_y3 = 10;
int snake_length = 3;
// ... å¾ˆéš¾ç®¡ç†ï¼
```

```c
// âœ… ä½¿ç”¨ç»“æ„ä½“
typedef struct {
    int x;
    int y;
    int length;
} Snake;

Snake snake = {10, 10, 3};
```

---

## 6.2 ç»“æ„ä½“çš„å®šä¹‰

```c
// å®šä¹‰ç»“æ„ä½“ç±»å‹
struct Point {
    int x;
    int y;
};

// åˆ›å»ºç»“æ„ä½“å˜é‡
struct Point p1;
p1.x = 10;
p1.y = 20;

// æˆ–è€…åˆå§‹åŒ–
struct Point p2 = {30, 40};
```

### ä½¿ç”¨ typedef ç®€åŒ–

```c
// ä½¿ç”¨ typedef åˆ›å»ºåˆ«å
typedef struct {
    int x;
    int y;
} Point;

// ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨ Pointï¼Œä¸éœ€è¦ struct å…³é”®å­—
Point p = {10, 20};
```

---

## 6.3 è®¿é—®ç»“æ„ä½“æˆå‘˜

```c
typedef struct {
    int x;
    int y;
    int length;
    char direction;
} Snake;

Snake snake = {10, 10, 3, 'R'};

// ä½¿ç”¨ç‚¹è¿ç®—ç¬¦è®¿é—®æˆå‘˜
printf("è›‡çš„ä½ç½®ï¼š(%d, %d)\n", snake.x, snake.y);
printf "è›‡çš„é•¿åº¦ï¼š%d\n", snake.length);
printf "è›‡çš„æ–¹å‘ï¼š%c\n", snake.direction);

// ä¿®æ”¹æˆå‘˜
snake.x += 1;
snake.direction = 'D';
```

---

## 6.4 è´ªåƒè›‡ä¸­çš„ç»“æ„ä½“

### ç‚¹ç»“æ„ä½“
```c
typedef struct {
    int x;
    int y;
} Point;
```

### è›‡ç»“æ„ä½“
```c
typedef struct Snake {
    Point position;      // ä½ç½®
    int length;          // é•¿åº¦
    int direction;       // æ–¹å‘
    bool alive;          // æ˜¯å¦å­˜æ´»
} Snake;
```

### é£Ÿç‰©ç»“æ„ä½“
```c
typedef struct {
    Point position;      // ä½ç½®
    int value;           // åˆ†æ•°å€¼
    bool active;         // æ˜¯å¦æ¿€æ´»
} Food;
```

### æ¸¸æˆç»“æ„ä½“
```c
typedef struct {
    Snake snake;         // è›‡
    Food food;           // é£Ÿç‰©
    int score;           // åˆ†æ•°
    int level;           // ç­‰çº§
    bool running;        // æ¸¸æˆæ˜¯å¦è¿è¡Œ
} Game;
```

---

## 6.5 ç»“æ„ä½“æ•°ç»„

```c
// å®šä¹‰è›‡èº«æ®µ
typedef struct {
    int x;
    int y;
} Segment;

// åˆ›å»ºè›‡èº«æ•°ç»„
Segment body[100];  // æœ€å¤š 100 æ®µ

// åˆå§‹åŒ–
body[0] = (Segment){10, 10};  // å¤´éƒ¨
body[1] = (Segment){9, 10};   // èº«ä½“
body[2] = (Segment){8, 10};   // å°¾éƒ¨

// è®¿é—®
printf("å¤´éƒ¨ä½ç½®ï¼š(%d, %d)\n", body[0].x, body[0].y);
```

---

## 6.6 ç»“æ„ä½“æŒ‡é’ˆ

å½“ç»“æ„ä½“å¾ˆå¤§æ—¶ï¼Œä¼ é€’æŒ‡é’ˆæ›´é«˜æ•ˆï¼š

```c
typedef struct {
    int x, y, length;
    // ... å¾ˆå¤šæˆå‘˜
} Snake;

// ä¼ é€’ç»“æ„ä½“ï¼ˆå¤åˆ¶æ•´ä¸ªç»“æ„ä½“ï¼‰
void move_snake(Snake snake) {
    snake.x += 1;  // åªä¿®æ”¹äº†å‰¯æœ¬
}

// ä¼ é€’æŒ‡é’ˆï¼ˆä¿®æ”¹åŸç»“æ„ä½“ï¼‰
void move_snake_ptr(Snake* snake) {
    snake->x += 1;  // ä¿®æ”¹åŸç»“æ„ä½“
}

// ä½¿ç”¨
Snake s = {10, 10, 3};
move_snake_ptr(&s);  // ä¼ é€’åœ°å€
```

### `->` è¿ç®—ç¬¦

```c
Snake* snake_ptr = &snake;

// ä¸¤ç§æ–¹å¼è®¿é—®æˆå‘˜
snake_ptr->x = 10;   // æ¨èï¼Œç®€æ´
(*snake_ptr).x = 10; // ç­‰ä»·ï¼Œä½†ç¹ç
```

---

## 6.7 åµŒå¥—ç»“æ„ä½“

ç»“æ„ä½“å¯ä»¥åŒ…å«å…¶ä»–ç»“æ„ä½“ï¼š

```c
typedef struct {
    int x;
    int y;
} Point;

typedef struct {
    Point position;    // åµŒå¥—ç»“æ„ä½“
    Point velocity;
} GameObject;

// ä½¿ç”¨
GameObject player;
player.position.x = 100;
player.position.y = 200;
player.velocity.x = 5;
player.velocity.y = 0;
```

---

## 6.8 å®Œæ•´ç¤ºä¾‹ï¼šè´ªåƒè›‡æ•°æ®ç»“æ„

```c
#include <stdio.h>
#include <stdbool.h>

// æ–¹å‘æšä¸¾
typedef enum {
    DIR_UP,
    DIR_DOWN,
    DIR_LEFT,
    DIR_RIGHT
} Direction;

// ç‚¹ç»“æ„ä½“
typedef struct {
    int x;
    int y;
} Point;

// è›‡èº«æ®µ
typedef struct Segment {
    Point position;
    struct Segment* next;  // æŒ‡å‘ä¸‹ä¸€æ®µï¼ˆé“¾è¡¨ï¼‰
} Segment;

// è›‡
typedef struct {
    Segment* head;      // å¤´éƒ¨
    Segment* tail;      // å°¾éƒ¨
    int length;         // é•¿åº¦
    Direction dir;      // æ–¹å‘
} Snake;

// é£Ÿç‰©
typedef struct {
    Point position;
    int value;
    bool active;
} Food;

// æ¸¸æˆ
typedef struct {
    Snake snake;
    Food food;
    int score;
    int high_score;
    int level;
    bool running;
    bool paused;
} Game;

// åˆ›å»ºæ–°è›‡
Snake* snake_create(int start_x, int start_y) {
    Snake* snake = malloc(sizeof(Snake));
    snake->head = malloc(sizeof(Segment));
    snake->head->position = (Point){start_x, start_y};
    snake->head->next = NULL;
    snake->tail = snake->head;
    snake->length = 1;
    snake->dir = DIR_RIGHT;
    return snake;
}

// ç§»åŠ¨è›‡
void snake_move(Snake* snake) {
    // æ ¹æ®æ–¹å‘è®¡ç®—æ–°ä½ç½®
    Point new_head = snake->head->position;
    
    switch (snake->dir) {
        case DIR_UP:    new_head.y -= 1; break;
        case DIR_DOWN:  new_head.y += 1; break;
        case DIR_LEFT:  new_head.x -= 1; break;
        case DIR_RIGHT: new_head.x += 1; break;
    }
    
    // åˆ›å»ºæ–°å¤´éƒ¨
    Segment* new_segment = malloc(sizeof(Segment));
    new_segment->position = new_head;
    new_segment->next = snake->head;
    snake->head = new_segment;
    snake->length++;
    
    // ç§»é™¤å°¾éƒ¨ï¼ˆé™¤éåœ¨ç”Ÿé•¿ï¼‰
    // ...
}

int main(void) {
    // åˆ›å»ºæ¸¸æˆ
    Game game = {0};
    game.snake = *snake_create(10, 10);
    game.score = 0;
    game.level = 1;
    game.running = true;
    
    printf("æ¸¸æˆåˆå§‹åŒ–å®Œæˆ!\n");
    printf("è›‡çš„åˆå§‹ä½ç½®ï¼š(%d, %d)\n", 
           game.snake.head.position.x, 
           game.snake.head.position.y);
    
    return 0;
}
```

---

## âœ… æœ¬è¯¾æ£€æŸ¥æ¸…å•

- [ ] ç†è§£ç»“æ„ä½“çš„æ¦‚å¿µ
- [ ] ä¼šå®šä¹‰å’Œä½¿ç”¨ç»“æ„ä½“
- [ ] ç†è§£ typedef çš„ä½œç”¨
- [ ] ä¼šä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆ
- [ ] ç†è§£ `->` å’Œ `.` çš„åŒºåˆ«
- [ ] ä¼šåˆ›å»ºåµŒå¥—ç»“æ„ä½“

---

## ğŸ“ ä½œä¸š

1. å®šä¹‰ä¸€ä¸ª `Player` ç»“æ„ä½“ï¼ŒåŒ…å«ï¼š
   - åå­—ï¼ˆå­—ç¬¦ä¸²ï¼‰
   - åˆ†æ•°ï¼ˆæ•´æ•°ï¼‰
   - ç­‰çº§ï¼ˆæ•´æ•°ï¼‰
   - æ˜¯å¦å­˜æ´»ï¼ˆå¸ƒå°”ï¼‰

2. å®šä¹‰ä¸€ä¸ª `Rectangle` ç»“æ„ä½“ï¼ŒåŒ…å«ä¸¤ä¸ª `Point`ï¼ˆå·¦ä¸Šè§’å’Œå³ä¸‹è§’ï¼‰

3. ç¼–å†™å‡½æ•°è®¡ç®—çŸ©å½¢çš„é¢ç§¯å’Œå‘¨é•¿

---

ä¸‹ä¸€è¯¾ï¼š[æŒ‡é’ˆåŸºç¡€](07-æŒ‡é’ˆåŸºç¡€.md)
