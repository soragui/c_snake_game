# ç¬¬ 7 è¯¾ï¼šæŒ‡é’ˆåŸºç¡€ ğŸ”—

æŒ‡é’ˆæ˜¯ C è¯­è¨€çš„çµé­‚ã€‚ç†è§£æŒ‡é’ˆæ˜¯æŒæ¡ C è¯­è¨€çš„å…³é”®ï¼

---

## 7.1 ä»€ä¹ˆæ˜¯æŒ‡é’ˆï¼Ÿ

**æŒ‡é’ˆæ˜¯ä¸€ä¸ªå­˜å‚¨å†…å­˜åœ°å€çš„å˜é‡ã€‚**

æƒ³è±¡å†…å­˜æ˜¯ä¸€æ’æˆ¿å­ï¼Œæ¯ä¸ªæˆ¿å­æœ‰é—¨ç‰Œå·ï¼ˆåœ°å€ï¼‰ï¼š

```
å†…å­˜åœ°å€ï¼š  1000    1004    1008    1012
          â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”
æ•°æ®ï¼š     â”‚  42 â”‚ â”‚ 3.14â”‚ â”‚ 'A' â”‚ â”‚1000 â”‚
          â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”˜
                                    â†‘
                                   æŒ‡é’ˆï¼ˆå­˜å‚¨ 1000 è¿™ä¸ªåœ°å€ï¼‰
```

---

## 7.2 æŒ‡é’ˆçš„å£°æ˜

```c
int number = 42;      // æ™®é€šå˜é‡
int* ptr;             // æŒ‡é’ˆå˜é‡ï¼Œå¯ä»¥å­˜å‚¨ int çš„åœ°å€
ptr = &number;        // & å–åœ°å€è¿ç®—ç¬¦ï¼Œè·å– number çš„åœ°å€
```

### å›¾ç¤º

```
number (int)          ptr (int*)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   42    â”‚          â”‚  0x1000 â”‚  â† å­˜å‚¨çš„æ˜¯ number çš„åœ°å€
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘                    â”‚
 0x1000 (åœ°å€)           â””â”€â”€ æŒ‡å‘ number
```

---

## 7.3 ä¸¤ä¸ªé‡è¦è¿ç®—ç¬¦

### `&` - å–åœ°å€è¿ç®—ç¬¦
```c
int x = 10;
int* ptr = &x;  // ptr å­˜å‚¨ x çš„åœ°å€
```

### `*` - è§£å¼•ç”¨è¿ç®—ç¬¦
```c
int x = 10;
int* ptr = &x;

printf("%d\n", *ptr);  // è¾“å‡º 10ï¼Œè®¿é—® ptr æŒ‡å‘çš„å€¼
*ptr = 20;             // ä¿®æ”¹ ptr æŒ‡å‘çš„å€¼ä¸º 20
printf("%d\n", x);     // è¾“å‡º 20ï¼Œx è¢«ä¿®æ”¹äº†ï¼
```

---

## 7.4 æŒ‡é’ˆçš„ç±»å‹

```c
int* int_ptr;         // æŒ‡å‘ int çš„æŒ‡é’ˆ
float* float_ptr;     // æŒ‡å‘ float çš„æŒ‡é’ˆ
char* char_ptr;       // æŒ‡å‘ char çš„æŒ‡é’ˆ
void* void_ptr;       // é€šç”¨æŒ‡é’ˆï¼Œå¯ä»¥æŒ‡å‘ä»»ä½•ç±»å‹

int x = 10;
int_ptr = &x;         // âœ… ç±»å‹åŒ¹é…

float f = 3.14f;
int_ptr = &f;         // âš ï¸ ç±»å‹ä¸åŒ¹é…ï¼Œä¼šæœ‰è­¦å‘Š
```

---

## 7.5 æŒ‡é’ˆä¸æ•°ç»„

æ•°ç»„åæœ¬è´¨ä¸Šæ˜¯æŒ‡é’ˆï¼š

```c
int arr[5] = {1, 2, 3, 4, 5};

// æ•°ç»„åå°±æ˜¯æŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ çš„æŒ‡é’ˆ
printf("%p\n", arr);      // æ•°ç»„é¦–åœ°å€
printf("%p\n", &arr[0]);  // åŒä¸Š

// æŒ‡é’ˆç®—æœ¯
printf("%d\n", *arr);      // 1ï¼Œç¬¬ä¸€ä¸ªå…ƒç´ 
printf("%d\n", *(arr+1));  // 2ï¼Œç¬¬äºŒä¸ªå…ƒç´ 
printf("%d\n", arr[2]);    // 3ï¼Œç¬¬ä¸‰ç§å†™æ³•
```

### æŒ‡é’ˆéå†æ•°ç»„

```c
int arr[5] = {10, 20, 30, 40, 50};
int* ptr = arr;  // æŒ‡å‘æ•°ç»„å¼€å¤´

// æ–¹æ³• 1ï¼šæŒ‡é’ˆç®—æœ¯
for (int i = 0; i < 5; i++) {
    printf("%d ", *(ptr + i));
}

// æ–¹æ³• 2ï¼šç§»åŠ¨æŒ‡é’ˆ
for (int i = 0; i < 5; i++) {
    printf("%d ", *ptr);
    ptr++;  // ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ 
}
```

---

## 7.6 æŒ‡é’ˆä¸å‡½æ•°

### ä¼ å€¼ vs ä¼ æŒ‡é’ˆ

```c
// ä¼ å€¼ï¼šå‡½æ•°å†…ä¿®æ”¹ä¸å½±å“åŸå˜é‡
void increment_by_value(int x) {
    x++;  // åªä¿®æ”¹äº†å‰¯æœ¬
}

// ä¼ æŒ‡é’ˆï¼šå‡½æ•°å†…ä¿®æ”¹å½±å“åŸå˜é‡
void increment_by_pointer(int* x) {
    (*x)++;  // ä¿®æ”¹åŸå˜é‡
}

int main(void) {
    int a = 10;
    int b = 10;
    
    increment_by_value(a);
    increment_by_pointer(&b);
    
    printf("a = %d\n", a);  // 10ï¼Œæ²¡å˜
    printf("b = %d\n", b);  // 11ï¼Œå˜äº†ï¼
    
    return 0;
}
```

---

## 7.7 è´ªåƒè›‡ä¸­çš„æŒ‡é’ˆåº”ç”¨

### ä¿®æ”¹æ¸¸æˆçŠ¶æ€

```c
typedef struct {
    int score;
    bool running;
} Game;

// âŒ ä¼ å€¼ï¼šæ— æ³•ä¿®æ”¹åŸæ¸¸æˆ
void reset_game(Game game) {
    game.score = 0;
    game.running = true;
}

// âœ… ä¼ æŒ‡é’ˆï¼šå¯ä»¥ä¿®æ”¹åŸæ¸¸æˆ
void reset_game_ptr(Game* game) {
    game->score = 0;
    game->running = true;
}

int main(void) {
    Game g = {100, false};
    
    reset_game(g);           // æ²¡ç”¨
    reset_game_ptr(&g);      // æœ‰æ•ˆï¼
    
    return 0;
}
```

### åŠ¨æ€åˆ›å»ºè›‡

```c
typedef struct Snake {
    int x, y, length;
} Snake;

// åœ¨å †ä¸Šåˆ›å»ºè›‡ï¼ˆç”Ÿå‘½å‘¨æœŸç”±ä½ æ§åˆ¶ï¼‰
Snake* create_snake(int x, int y) {
    Snake* snake = malloc(sizeof(Snake));
    snake->x = x;
    snake->y = y;
    snake->length = 1;
    return snake;
}

// ä½¿ç”¨
Snake* my_snake = create_snake(10, 10);
printf("è›‡åœ¨ (%d, %d)\n", my_snake->x, my_snake->y);

// ç”¨å®Œè¦é‡Šæ”¾
free(my_snake);
```

---

## 7.8 æŒ‡é’ˆæ•°ç»„

```c
// æŒ‡é’ˆæ•°ç»„ï¼šæ•°ç»„çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯æŒ‡é’ˆ
int a = 1, b = 2, c = 3;
int* ptr_array[3] = {&a, &b, &c};

printf("%d\n", *ptr_array[0]);  // 1
printf("%d\n", *ptr_array[1]);  // 2
printf("%d\n", *ptr_array[2]);  // 3
```

---

## 7.9 å¸¸è§é”™è¯¯

### é”™è¯¯ 1ï¼šæœªåˆå§‹åŒ–çš„æŒ‡é’ˆ
```c
int* ptr;      // âŒ æœªåˆå§‹åŒ–ï¼ŒæŒ‡å‘éšæœºåœ°å€
*ptr = 10;     // âŒ å±é™©ï¼å¯èƒ½å´©æºƒ

int x = 10;
int* ptr = &x; // âœ… æ­£ç¡®
```

### é”™è¯¯ 2ï¼šé‡æŒ‡é’ˆ
```c
int* ptr = malloc(sizeof(int));
free(ptr);     // é‡Šæ”¾å†…å­˜
*ptr = 10;     // âŒ é‡æŒ‡é’ˆï¼å†…å­˜å·²é‡Šæ”¾

ptr = NULL;    // âœ… é‡Šæ”¾åç½®ä¸º NULL
```

### é”™è¯¯ 3ï¼šç±»å‹ä¸åŒ¹é…
```c
int x = 10;
float* ptr = &x;  // âš ï¸ ç±»å‹ä¸åŒ¹é…
```

---

## 7.10 æŒ‡é’ˆæ€»ç»“

```c
int x = 42;
int* ptr = &x;

// å„ç§è®¿é—®æ–¹å¼
printf("%d\n", x);      // 42ï¼Œç›´æ¥è®¿é—®
printf("%p\n", &x);     // åœ°å€ï¼Œx çš„åœ°å€
printf("%d\n", *ptr);   // 42ï¼Œè§£å¼•ç”¨
printf("%p\n", ptr);    // åœ°å€ï¼Œptr å­˜å‚¨çš„å€¼ï¼ˆx çš„åœ°å€ï¼‰
printf("%p\n", &ptr);   // åœ°å€ï¼Œptr è‡ªå·±çš„åœ°å€
```

---

## âœ… æœ¬è¯¾æ£€æŸ¥æ¸…å•

- [ ] ç†è§£æŒ‡é’ˆçš„æ¦‚å¿µ
- [ ] ä¼šä½¿ç”¨ `&` å’Œ `*` è¿ç®—ç¬¦
- [ ] ç†è§£ä¼ å€¼å’Œä¼ æŒ‡é’ˆçš„åŒºåˆ«
- [ ] çŸ¥é“æŒ‡é’ˆå’Œæ•°ç»„çš„å…³ç³»
- [ ] èƒ½é¿å…å¸¸è§æŒ‡é’ˆé”™è¯¯

---

## ğŸ“ ä½œä¸š

1. ç¼–å†™ç¨‹åºï¼Œç”¨æŒ‡é’ˆäº¤æ¢ä¸¤ä¸ªæ•´æ•°çš„å€¼ï¼š
```c
void swap(int* a, int* b) {
    // å®ç°äº¤æ¢
}
```

2. ç”¨æŒ‡é’ˆéå†æ•°ç»„ï¼Œæ‰¾å‡ºæœ€å¤§å€¼

3. åˆ›å»ºä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆï¼Œä¿®æ”¹å…¶æˆå‘˜çš„å€¼

---

ä¸‹ä¸€è¯¾ï¼š[å†…å­˜ç®¡ç†](08-å†…å­˜ç®¡ç†.md)
